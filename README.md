# AdaptixC2 Cert Vulnerability Detector

This Python script parses the output from the `certi_enum` Beacon Object File (BOF) in the [Adaptix Framework Extension Kit](https://github.com/Adaptix-Framework/Extension-Kit) and identifies Active Directory Certificate Services (AD CS) vulnerabilities using the same detection logic as Certipy for ESC1-ESC16 vulnerabilities.

## Overview

The script analyzes the output generated by the `certi_enum` BOF from Adaptix Extension Kit, which performs AD CS enumeration similar to Certipy. It then identifies potential ESC (Enterprise Security Configuration) vulnerabilities in the certificate templates and Certificate Authorities.

## Features

- Parses output from Adaptix Extension Kit's `certi_enum` BOF
- Identifies ESC1-ESC16 vulnerabilities
- Dual detection methods: template names and detailed attribute analysis
- Structured vulnerability reporting
- Compatible with the output format of the AD-BOF module

## Supported ESC Vulnerability Types

- **ESC1**: Client authentication template allows enrollee to supply subject
- **ESC2**: Any purpose template
- **ESC3**: Certificate Request Agent EKU
- **ESC4**: Dangerous permissions or ownership
- **ESC6**: CA allows user-specified SAN and auto-issues certificates
- **ESC7**: CA with dangerous permissions
- **ESC8**: Insecure web enrollment
- **ESC9**: No security extension
- **ESC11**: Unencrypted certificate requests
- **ESC13**: Template linked to group through issuance policy
- **ESC15**: Schema v1 template allows enrollee to supply subject
- **ESC16**: Security extension disabled

## Usage

```bash
# First, run the certi_enum BOF from Adaptix Extension Kit
execute bof ~/path/to/Extension-Kit/AD-BOF/_bin/certi_enum.x64.o

# Save the BOF output to a file, then run the detector
python3 adaptix_Cert_vuln_detector.py <bof_output_file>
```

## Sample Output

```
AD CS Vulnerability Analysis Results
==================================================

ESC13:
  - Template: ESC13

ESC9:
  - Template: ESC9
  - Template: ClientAuth

ESC4:
  - Template: ESC4

ESC3:
  - Template: ESC3-CRA
  - Template: ESC3

ESC2:
  - Template: ESC2

ESC1:
  - Template: ESC1

Total vulnerabilities found: 8
```

## Dependencies

- Python 3.6+
- No external dependencies required

## How It Works

The script detects vulnerabilities through two methods:

1. **Template Name Detection**: If the CA's template list contains names starting with "ESC", they are directly identified as the corresponding vulnerability type
2. **Attribute Analysis Detection**: Analyzes detailed certificate template and CA properties using Cert's detection logic

## Prerequisites

- Output from Adaptix Extension Kit's `certi_enum` BOF
- The BOF output should be saved to a text file for analysis

## Compatibility

- Designed specifically for the output format of Adaptix Extension Kit's `certi_enum` BOF
- Based on Certipy's vulnerability detection logic
- May need updates if the BOF output format changes

## Important Notes

- This script performs static analysis only and does not perform any network connections or privilege verification
- Use only in environments where you have explicit authorization
- Unauthorized use may be illegal

## Related Projects

- [Adaptix Framework Extension Kit](https://github.com/Adaptix-Framework/Extension-Kit) - The BOF framework this detector is designed for
- [Certipy](https://github.com/ly4k/Certipy) - Original vulnerability detection logic

## Author

Based on Certipy's vulnerability detection logic, adapted for Adaptix Extension Kit BOF output analysis.
